<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>AJAX</title>
  </head>

  <body>
    <h1>Learn AJAX</h1>
    <div id="output"></div>
    <button id="loadNew">Load</button>

    <script type="text/javascript">
      // 빈태그 output을 변수로 저장
      var output = document.getElementById("output");
      // 버튼을 변수저장 => 버튼을 클릭시 이벤트로 ajax로 제이슨 데이터를 가져옴.
      var buttonClick = document.getElementById("loadNew");
      // 버튼에 이벤트 클릭시 익명함수를 실행 => loadAjax()
      buttonClick.addEventListener("click", function () {
        loadAjax();
      });
      function loadAjax() {
        //버튼 클릭시 실행되는 함수
        var ajax = new XMLHttpRequest(); //기본선언 문법
        ajax.onreadystatechange = function () {
          //console.log('state changed',ajax.readyState,ajax.status)
          if (ajax.readyState == 4 && ajax.status == 200) {
            // console.log(ajax.responseText)
            var json = JSON.parse(ajax.responseText); //객체형식으로 제이슨을 변환            var data = json.results[0];

            var message =
              "<h2>" +
              data.name.first +
              "  " +
              data.name.last +
              '</h2><img src="' +
              data.picture.large +
              '">';

            output.innerHTML = message;
          }
        };
        ajax.open("GET", "https://randomuser.me/api/", true); //get방식, 요청http주소
        ajax.send(); //요청하기
      }
    </script>
  </body>
</html>
